---
layout: forestry
german: false
published: true
comments: false
stories: true
genres: Blog
tickers: false
author: https://reddit.com/u/KarlVonBahnhof
author_name: KarlVonBahnhof
title: Trezor devices have serious security vulnerability
date: 2017-08-17 14:18:25 +0200
description: "...even after yesterdays security update of the firmware."
permalink: "/trezor-hack"
image_alt:
- The only way to keep Trezor (and Keepkey!) safe is to lock it up in a trezor. You
  could have done that with a paper wallet though...
image:
- "/img/bitfinex/gox.png"
update: 2017-08-17 14:00:00 +0200
categories:
- altcoins
- wallets
tags:
- wallets
chart: []
identifier:
- trezorhack
---
Just yesterday, Trezor released a security update. It updated your firmware to version 1.5.2 as older versions of firmware could make your seedphrase visible to someone who'd steal the device, took it apart and flashed it with a hacked-up firmware.

[Here](https://blog.trezor.io/trezor-firmware-security-update-1-5-2-5ef1b6f13fed) is the official story from Satoshi Labs:

> It is important to note that this is not a remote execution attack. To exploit this issue, an attacker would need physical access to a disassembled TREZOR device with uncovered electronics. It is impossible to do this without destroying the plastic case.

> In order to exploit this issue, an attacker would have to break into the device, destroying the case in the process. They would also need to flash the device with a specially-crafted firmware. If your device is intact, your seed is safe, and you should update your firmware to 1.5.2 as soon as possible.

> With firmware 1.5.2, this attack vector is eliminated and your device is safe.

As it happens, [the unofficial version](https://medium.com/@Zero404Cool/trezor-security-glitches-reveal-your-private-keys-761eeab03ff8) is a lot worse:

The frantic patch creation we see now, before any coins have been lost (apparently), is because the [issue was talked about at DEF CON 25](https://media.defcon.org/DEF%20CON%2025/DEF%20CON%2025%20presentations/DEFCON-25-Datko-and-Quartier-Breaking-Bitcoin-Hardware-Wallets.pdf). All Trezors, regardless of the firmware, use a chip that is vulnerable. According to the author of the article linked above, the chip will always be vulnerable in some way and Trezors are not safe unless all devices are replaced with ones that use safer chips.

<img src="https://cdn-images-1.medium.com/max/1000/1*wZCWyhLJHmg_6S2XqFwdTQ.jpeg" style="max-width:100%">

Furthermore:

> Trezor so far greatly downplays the importance of this hack. There is no long-term access needed to copy all your secret information from Trezor using this hack, **it can be done just in 15 seconds**. If your Trezor is stolen, you don’t even have time to transfer you funds to a new address. **Government authorities can access all your Bitcoins and other crypto currencies without even asking for your consent. If you are crossing an international border, TSA can easily check your balances, etc.** IRL, Trezor is as safe as leaving your cash or wallet on the table. On top of all that, your Trezor can be restored to its original state or replaced with identical Trezor with the same configuration, you wouldn’t even notice any difference until it is too late.

The exploit surely now can be done in 15 seconds at the airport since the [source code for it is public](https://satoshibox.com/fwipady7nvbqoqreeso4cf82).

> The key to performing this hack is simply connecting two pins inside the Trezor device at the right time, even paperclip is suitable for this.

> Only a simple version of this hack requires the disassembly of Trezor. A more advanced version also exists. No disassembly is required!

The author linked a satoshibox file with an exploit for the new firmware (1.5.2) but the link is broken.

#### What can you do?

* **Turn on password protection**. Passwords in Trezor create a 25th word of a seedphrase. Trezor claims password protection makes the devices safe against this exploit, it is for researchers now to prove or disprove that.

* **Keep your Trezor in a vault, don't have it on you when you cross borders.** You could have done better with a paper wallet though, or simply with a seedphrase note, couldn't you?

* **Build your own cold storage solution.** Back in the day, people used to use a spare clean computer with Armory or Electrum. [BitcoinArmory is maintained again](https://github.com/goatpig/BitcoinArmory/graphs/contributors) but Electrum is the wallet that gets forked to support your altcoin of the month. When you have doubts as to whether to trust a wallet software, like many people had with Bitcoin Cash wallet Electron, you can always install it on a virtual machine.
